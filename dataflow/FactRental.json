{
	"name": "FactRental",
	"properties": {
		"folder": {
			"name": "Project"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"linkedService": {
						"referenceName": "saw-uofu-is6480-dldwhndev-001-WorkspaceDefaultStorage",
						"type": "LinkedServiceReference"
					},
					"name": "sourceDimCustomer"
				},
				{
					"linkedService": {
						"referenceName": "saw-uofu-is6480-dldwhndev-001-WorkspaceDefaultStorage",
						"type": "LinkedServiceReference"
					},
					"name": "sourceDimFilm"
				},
				{
					"linkedService": {
						"referenceName": "saw-uofu-is6480-dldwhndev-001-WorkspaceDefaultStorage",
						"type": "LinkedServiceReference"
					},
					"name": "sourceDimRental"
				},
				{
					"linkedService": {
						"referenceName": "saw-uofu-is6480-dldwhndev-001-WorkspaceDefaultStorage",
						"type": "LinkedServiceReference"
					},
					"name": "sourceDimRentalDate"
				}
			],
			"sinks": [
				{
					"linkedService": {
						"referenceName": "saw-uofu-is6480-dldwhndev-001-WorkspaceDefaultStorage",
						"type": "LinkedServiceReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "union1"
				},
				{
					"name": "select1"
				},
				{
					"name": "join1"
				},
				{
					"name": "join2"
				},
				{
					"name": "lookup1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          CustomerKey as long,",
				"          CustomerID as short,",
				"          StoreID as short,",
				"          FirstName as string,",
				"          LastName as string,",
				"          create_date as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     format: 'delta',",
				"     fileSystem: 'fsuofuis6480dldw001',",
				"     folderPath: 'IS6480_DW_GroupSix_Project/DimCustomer') ~> sourceDimCustomer",
				"source(output(",
				"          FilmKey as long,",
				"          FilmID as short,",
				"          CategoryID as short,",
				"          Name as string,",
				"          Title as string,",
				"          Description as string,",
				"          RentalRate as double,",
				"          Rating as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     format: 'delta',",
				"     fileSystem: 'fsuofuis6480dldw001',",
				"     folderPath: 'IS6480_DW_GroupSix_Project/DimFilm') ~> sourceDimFilm",
				"source(output(",
				"          RentalKey as long,",
				"          RentalID as short,",
				"          RentalDate as string,",
				"          InventoryID as short,",
				"          CustomerID as short,",
				"          ReturnDate as string,",
				"          FilmID as short,",
				"          StoreID as short,",
				"          PaymentID as short,",
				"          Amount as double",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     format: 'delta',",
				"     fileSystem: 'fsuofuis6480dldw001',",
				"     folderPath: 'IS6480_DW_GroupSix_Project/DimRental') ~> sourceDimRental",
				"source(output(",
				"          RentalID as short,",
				"          RentalDate as date,",
				"          InventoryID as short,",
				"          CustomerID as short,",
				"          ReturnDate as date,",
				"          DateKey as long,",
				"          DayOfWeek as integer,",
				"          WeekOfYear as integer,",
				"          Month as integer",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     format: 'delta',",
				"     fileSystem: 'fsuofuis6480dldw001',",
				"     folderPath: 'IS6480_DW_GroupSix_Project/DimDate') ~> sourceDimRentalDate",
				"sourceDimRental, sourceDimFilm union(byName: true)~> union1",
				"union1 select(mapColumn(",
				"          RentalKey,",
				"          CustomerKey,",
				"          RentalID,",
				"          RentalDate,",
				"          InventoryID,",
				"          CustomerID,",
				"          ReturnDate,",
				"          FilmID,",
				"          StoreID,",
				"          PaymentID,",
				"          Amount,",
				"          FirstName,",
				"          LastName",
				"     ),",
				"     skipDuplicateMapInputs: false,",
				"     skipDuplicateMapOutputs: false) ~> select1",
				"select1, sourceDimFilm join(select1@FilmID == FilmKey,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join1",
				"lookup1, sourceDimRentalDate join(RentalKey == sourceDimRentalDate@RentalID,",
				"     joinType:'right',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join2",
				"join1, sourceDimRentalDate lookup(RentalKey == sourceDimRentalDate@RentalID,",
				"     multiple: false,",
				"     pickup: 'any',",
				"     broadcast: 'auto')~> lookup1",
				"join2 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'delta',",
				"     fileSystem: 'fsuofuis6480dldw001',",
				"     folderPath: 'IS6480_DW_GroupSix_Project/FactRental',",
				"     mergeSchema: false,",
				"     autoCompact: false,",
				"     optimizedWrite: false,",
				"     vacuum: 0,",
				"     deletable: false,",
				"     insertable: true,",
				"     updateable: false,",
				"     upsertable: false,",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     mapColumn(",
				"          CustomerKey,",
				"          RentalKey,",
				"          FilmKey,",
				"          RentalDate,",
				"          InventoryID,",
				"          ReturnDate,",
				"          StoreID,",
				"          Amount,",
				"          FirstName,",
				"          LastName,",
				"          create_date,",
				"          Name,",
				"          Title,",
				"          Description,",
				"          RentalRate,",
				"          Rating",
				"     )) ~> sink1"
			]
		}
	}
}